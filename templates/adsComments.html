{% extends 'base.html' %}
{% load static%}

{% block title %}
       {{ads.subject}}
{%endblock%}



{% block breadcrumb %}
  <li class="breadcrumb-item "><a href="{% url 'home'%}">Section</a></li>
<li class="breadcrumb-item"><a href="{% url 'SectionAds' Ads.section.pk %}">{{Ads.section.name}}</a></li>
    <li class="breadcrumb-item active">{{Ads.subject}}</li>
 {%endblock%}


{% block content %}

{% if perms.AdsBoard.add_comments %}
<div class="mb-4">
    <a href="{% url 'replyAds' Ads.section.pk Ads.pk %}" class="btn btn-primary">Reply</a>
</div>
{%endif%}

    {% for comment in comments%}
<!--<div class="card mb-2">-->
<!--      <div class="card-body p-3">-->
<!--    <div class="row">-->
<!--    <div class="col-2">-->
<!--        <img class="w-100" src="{% static 'img/user.png' %}" alt="{{comments.created_by_username}}">-->
<!--    </div>-->
<!--        <div class="col-10">-->
<!--        <p>{{comments.created_by.username}}</p>-->
<!--            <p>{{comments.message}}</p>-->
<!--            <p>{{comments.created_dt}}</p>-->

<!--            {% if comments.created_by == user %}-->
<!--            <a href="" class="btn btn-primary">edit</a>-->
<!--            {%endif%}-->

<!--        </div>-->
<!--    </div>-->
<!--      </div></div>-->

<div class="card mb-2  border border-1">
      <div class="card-body p-3">
        <div class="row">
          <div class="col-2">
            <img src="{% static 'img/user.png' %}" alt="{{ comment.created_by.username }}" class="w-50">
          </div>
          <div class="col-10">
            <div class="row mb-3">
              <div class="col-6">
                <strong class="text-muted">{{ comment.created_by.username }}</strong>
              </div>
              <div class="col-6 text-right">
                <small class="text-muted">{{ comment.created_dt }}</small>
              </div>
            </div>
            {{ comment.message }}

            {% if comment.created_by == user and perms.AdsBoard.change_comments %}
              <div class="mt-3">
                <a href="{% url 'CommentUpdateView' comment.ads.section.pk comment.ads.pk comment.pk %}" class="btn btn-info btn-sm me-3" role="button">Edit</a>
                <a href="{% url 'CommentDelete' comment.ads.section.pk comment.ads.pk comment.pk %}" class="btn btn-danger btn-sm me-3" role="button">Delete</a>
              </div>
            {% elif comment.created_by.is_active == False  and user.is_staff  %}
                 <div class="mt-3">
                <a href="{% url 'CommentDelete' comment.ads.section.pk comment.ads.pk comment.pk %}" class="btn btn-danger btn-sm me-3" role="button">Delete</a>
                 </div>
            {% elif perms.AdsBoard.remove_comments and user.is_staff      %}
              <div class="mt-3">
                <a href="{% url 'CommentDelete' comment.ads.section.pk comment.ads.pk comment.pk %}" class="btn btn-danger btn-sm me-3" role="button">Delete</a>
                <a href="{% url 'BandUserComment' comment.ads.section.pk comment.ads.pk  comment.created_by.pk %}" class="btn btn-warning btn-sm" role="button">Band</a>

                 </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% endfor %}



{% if comments.has_other_pages %}
  <nav aria-label="Ads pagination" aria-label="..." class="mb-4 pt-3 pb-0">
    <ul class="pagination pagination-circle justify-content-center">
      {% if comments.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page={{ comments.previous_page_number }}">Previous</a>
        </li>
      {% else %}
        <li class="page-item disabled">
          <span class="page-link">Previous</span>
        </li>
      {% endif %}

      {% for page_num in comments.paginator.page_range %}
        {% if comments.number == page_num %}
          <li class="page-item active">
            <span class="page-link">
              {{ page_num }}
              <span class="sr-only">(current)</span>
            </span>
          </li>
        {% else %}
          <li class="page-item">
            <a class="page-link" href="?page={{ page_num }}">{{ page_num }}</a>
          </li>
        {% endif %}
      {% endfor %}

      {% if comments.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ comments.next_page_number }}">Next</a>
        </li>
      {% else %}
        <li class="page-item disabled">
          <span class="page-link">Next</span>
        </li>
      {% endif %}
    </ul>
  </nav>
{% endif %}

{%endblock%}